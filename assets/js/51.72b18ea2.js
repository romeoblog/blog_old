(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{223:function(a,t,s){"use strict";s.r(t);var e=s(4),r=Object(e.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"linux-免密码登陆及原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linux-免密码登陆及原理","aria-hidden":"true"}},[a._v("#")]),a._v(" Linux 免密码登陆及原理")]),a._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[a._v("#")]),a._v(" 前言")]),a._v(" "),s("p",[a._v("我们常常会遇到这种情况：从服务器A去连接服务器B，经常需要输入服务器B密码，方可连接。再比如，我们在搭建集群（主从节点）的时候，经常就需要通过 ssh 来启动和停止各个节点上的各种守护进程，这就需要在节点之间执行指令的版时候是不需要输入密码的方式，故我们需要配置 ssh 使用权无密码公钥认证的方式")]),a._v(" "),s("h2",{attrs:{id:"原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原理","aria-hidden":"true"}},[a._v("#")]),a._v(" 原理")]),a._v(" "),s("p",[a._v("非对称加密算法--RSA加密原理")]),a._v(" "),s("p",[a._v("了解详细算法："),s("a",{attrs:{href:"https://blog.csdn.net/wjiabin/article/details/85228078",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://blog.csdn.net/wjiabin/article/details/85228078"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"处理机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#处理机制","aria-hidden":"true"}},[a._v("#")]),a._v(" 处理机制")]),a._v(" "),s("ol",[s("li",[a._v("非对称密钥就是一对密钥：公钥和私钥。")]),a._v(" "),s("li",[a._v("私钥由自己服务器持有，保存在自己本地中，一般在 .ssh 目录下。")]),a._v(" "),s("li",[a._v("公钥则通过网络传递给对方服务，保存在对方服务中，一般 .ssh 目录下的 authorized_keys 文件。")]),a._v(" "),s("li",[a._v("通过私钥加密的数据只能由公钥解密，同样用公钥加密的数据也只有用私钥解密。")])]),a._v(" "),s("h2",{attrs:{id:"免密码机制流程图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#免密码机制流程图","aria-hidden":"true"}},[a._v("#")]),a._v(" 免密码机制流程图")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.willlu.cn/image/bigdata/%E5%85%8D%E5%AF%86%E7%A0%81%E7%99%BB%E9%99%86%E5%8E%9F%E7%90%86.png",alt:"免密码机制流程图"}})]),a._v(" "),s("h2",{attrs:{id:"步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤","aria-hidden":"true"}},[a._v("#")]),a._v(" 步骤")]),a._v(" "),s("h3",{attrs:{id:"创建公钥与私钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建公钥与私钥","aria-hidden":"true"}},[a._v("#")]),a._v(" 创建公钥与私钥")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@bigdata11 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ssh-keygen -t rsa")]),a._v("\nGenerating public/private rsa key pair.\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 连续按3次确认键")]),a._v("\nEnter "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("which")]),a._v(" to save the key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("/root/.ssh/id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nEnter passphrase "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("empty "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" no passphrase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nEnter same passphrase again: \nYour identification has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" /root/.ssh/id_rsa.\nYour public key has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\ndf:66:eb:74:2e:d8:c9:b5:ed:29:00:74:9a:4f:0f:ff root@bigdata11\nThe key's randomart image is:\n+--"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" RSA 2048"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("----+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("                 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("         "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v("     "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v(" +      "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("         + o     "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("        S + +    "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("         "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v(".")]),a._v(" + o.  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("          .+*ooo "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("          .+"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(".Eo"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("           .o.oo."),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+-----------------\n")])])]),s("h3",{attrs:{id:"将公钥发送对方服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将公钥发送对方服务器","aria-hidden":"true"}},[a._v("#")]),a._v(" 将公钥发送对方服务器")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@bigdata11 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ssh-copy-id -i /root/.ssh/id_rsa.pub root@bigdata11")]),a._v("\n/usr/bin/ssh-copy-id: INFO: attempting to log "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" with the new key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(", to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" remain to be installed -- "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" you are prompted now it is to "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" the new keys\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 这一步需要输入服务器密码")]),a._v("\nroot@bigdata11"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'s password: \n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   \"ssh '")]),a._v("root@bigdata11'\"\nand check to "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" sure that only the key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" you wanted were added.\n")])])]),s("h3",{attrs:{id:"验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#验证","aria-hidden":"true"}},[a._v("#")]),a._v(" 验证")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@bigdata11 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" bigdata12\n")])])]),s("p",[a._v("如果不用输入密码，则免密码配置成功！相反，如果服务B想免密码服务A, 循环以上步骤即可。")]),a._v(" "),s("h3",{attrs:{id:"查看免密码服务列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看免密码服务列表","aria-hidden":"true"}},[a._v("#")]),a._v(" 查看免密码服务列表")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@bigdata11 software"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# more ~/.ssh/authorized_keys ")]),a._v("\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQChruuNQh9jiIiOWsl998hz7J9q/bcfUZSlMQzq2Mj1wGCTUWDT7NyjOjTgJuzmh8cETcddRMPzWTfgqNw8lp4/WeVL61y3mrxIxYDypt/p7rQMpjzqifBb8JEiCMEKn\nTpkxoCDF9Wf5NYsUJAYwR4NsnZ9aS9iRMC+T57YGxhFOrZoKJZ0rhHOKvV+/JVDk2L7ApWgRLA/ySARgnB7qeo3QE4cVDP7svjN7SGblkXrE3DUNgPY7eAyv+SRtc1wIjE/fYgyXL5RDi/pwN5P8eHpnF9ncfBCtu5u+O\nQwGVU+FGSAlTTmldpH7djdwK6IqpLWI01TB5tnGu3GWRkwu3UJ root@bigdata11\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDR4G8DZYAOA0PJoKIO7u8rgrfzoTuAhsW+8ZBXXyKWcuFi/ck8kQGuGp4jE3G8p0sh28Ua++eEq6bZqIE7YZvT4bxdREBXkHzEGpxWyewM8EFd/hk+/rCX6wjl8b0iH\nd6tUkfnaGvBrWbTOQ+z3soq03lUbeBd6D5Bo/s8moAcDPPG02trSJHuTnLWm8/ejfaIneU9dfsqoNqba60doqJIAv+4/fHYOa/KKu4Bm48rY4+lakZ9M05IsQaEaAolDBr2N8YgnO9SJn+SEQCWvammRi0+ocLDkXE+di\nCbSoq2kAMHPeZXZBHfjt1OXVXu5I8sYNT2T14IGSJBVoqqnQFB root@bigdata12\n")])])])])},[],!1,null,null,null);t.default=r.exports}}]);